(()=>{var e={};e.id=550,e.ids=[550],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},2063:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),r(28376),r(49403),r(71363);var a=r(36576),t=r(72007),n=r(21818),i=r.n(n),l=r(88897),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(s,o);let d=["",{children:["perfil",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,28376)),"/home/ubuntu/crm-security-updated/app/app/perfil/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,49403)),"/home/ubuntu/crm-security-updated/app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,71363,23)),"next/dist/client/components/not-found-error"]}],c=["/home/ubuntu/crm-security-updated/app/app/perfil/page.tsx"],u="/perfil/page",m={require:r,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/perfil/page",pathname:"/perfil",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},77564:(e,s,r)=>{Promise.resolve().then(r.bind(r,20949))},20949:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>A});var a=r(62901),t=r(24383),n=r(84700),i=r(84374),l=r(3271),o=r(23803),d=r(27878),c=r(82657),u=r(34366),m=r(31606),x=r(74132),h="horizontal",p=["horizontal","vertical"],g=t.forwardRef((e,s)=>{let{decorative:r,orientation:t=h,...n}=e,i=p.includes(t)?t:h;return(0,a.jsx)(x.WV.div,{"data-orientation":i,...r?{role:"none"}:{"aria-orientation":"vertical"===i?i:void 0,role:"separator"},...n,ref:s})});g.displayName="Separator";var f=r(68637);let v=t.forwardRef(({className:e,orientation:s="horizontal",decorative:r=!0,...t},n)=>a.jsx(g,{ref:n,decorative:r,orientation:s,className:(0,f.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",e),...t}));v.displayName=g.displayName;var j=r(77185),b=r(19918),y=r(76021),N=r(24228),w=r(21680),P=r(44928),S=r(23094),k=r(60437),_=r(83025);function A(){let{data:e,update:s}=(0,n.useSession)();(0,i.useRouter)();let{toast:r}=(0,k.pm)(),[x,h]=(0,t.useState)(""),[p,g]=(0,t.useState)(""),[f,A]=(0,t.useState)(""),[E,Z]=(0,t.useState)(!1),[C,D]=(0,t.useState)(null),[R,F]=(0,t.useState)((0,_.uo)("")),M=async()=>{try{let e=await fetch("/api/profile");if(e.ok){let s=await e.json();D(s)}}catch(e){console.error("Erro ao carregar perfil:",e)}},V=async()=>{if(!x||!p||!f){r({title:"Erro",description:"Preencha todos os campos obrigat\xf3rios.",variant:"destructive"});return}if(!R.isValid){r({title:"Senha inv\xe1lida",description:R.errors.join("\n"),variant:"destructive"});return}if(p!==f){r({title:"Erro",description:"A nova senha e a confirma\xe7\xe3o n\xe3o coincidem.",variant:"destructive"});return}if(x===p){r({title:"Erro",description:"A nova senha deve ser diferente da senha atual.",variant:"destructive"});return}Z(!0);try{let e=await fetch("/api/profile/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:x,newPassword:p})}),s=await e.json();e.ok?(r({title:"Sucesso",description:"Senha alterada com sucesso!"}),h(""),g(""),A(""),M()):r({title:"Erro",description:s.message||"Erro ao alterar senha.",variant:"destructive"})}catch(e){console.error("Erro ao alterar senha:",e),r({title:"Erro",description:"Erro de conex\xe3o ao alterar senha.",variant:"destructive"})}finally{Z(!1)}};return e?.user?a.jsx(l.L,{children:(0,a.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Meu Perfil"}),a.jsx("p",{className:"text-gray-600",children:"Gerencie suas informa\xe7\xf5es pessoais e configura\xe7\xf5es de seguran\xe7a"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:(0,a.jsxs)(o.Zb,{children:[a.jsx(o.Ol,{children:(0,a.jsxs)(o.ll,{className:"flex items-center",children:[a.jsx(j.Z,{className:"h-5 w-5 mr-2"}),"Informa\xe7\xf5es Pessoais"]})}),(0,a.jsxs)(o.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx(c._,{className:"text-sm font-medium text-gray-600",children:"Nome"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.user.name})]}),(0,a.jsxs)("div",{children:[a.jsx(c._,{className:"text-sm font-medium text-gray-600",children:"E-mail"}),(0,a.jsxs)("div",{className:"flex items-center mt-1",children:[a.jsx(b.Z,{className:"h-4 w-4 text-gray-400 mr-2"}),a.jsx("p",{className:"text-sm text-gray-900",children:e.user.email})]})]}),(0,a.jsxs)("div",{children:[a.jsx(c._,{className:"text-sm font-medium text-gray-600",children:"Fun\xe7\xe3o"}),a.jsx("div",{className:"mt-1",children:a.jsx(m.C,{className:(e=>{switch(e){case"VENDEDOR":return"bg-blue-100 text-blue-800";case"DIRETORIA":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}})(e.user.role||""),children:(e=>{switch(e){case"VENDEDOR":return"Vendedor";case"DIRETORIA":return"Diretoria";default:return e}})(e.user.role||"")})})]}),C&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(v,{}),(0,a.jsxs)("div",{children:[a.jsx(c._,{className:"text-sm font-medium text-gray-600",children:"Membro desde"}),(0,a.jsxs)("div",{className:"flex items-center mt-1",children:[a.jsx(y.Z,{className:"h-4 w-4 text-gray-400 mr-2"}),a.jsx("p",{className:"text-sm text-gray-900",children:new Date(C.createdAt).toLocaleDateString("pt-BR")})]})]}),(0,a.jsxs)("div",{children:[a.jsx(c._,{className:"text-sm font-medium text-gray-600",children:"\xdaltima altera\xe7\xe3o de senha"}),(0,a.jsxs)("div",{className:"flex items-center mt-1",children:[a.jsx(N.Z,{className:"h-4 w-4 text-gray-400 mr-2"}),a.jsx("p",{className:"text-sm text-gray-900",children:C.lastPasswordChange?new Date(C.lastPasswordChange).toLocaleDateString("pt-BR"):"Nunca alterada"})]})]}),C.isTemporaryPassword&&a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:(0,a.jsxs)("div",{className:"flex items-start",children:[a.jsx(w.Z,{className:"h-4 w-4 text-yellow-600 mt-0.5 mr-2"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Senha Tempor\xe1ria"}),a.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"Voc\xea est\xe1 usando uma senha tempor\xe1ria. Altere sua senha agora para maior seguran\xe7a."})]})]})})]})]})]})}),a.jsx("div",{className:"lg:col-span-2",children:(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsxs)(o.ll,{className:"flex items-center",children:[a.jsx(P.Z,{className:"h-5 w-5 mr-2"}),"Alterar Senha"]}),a.jsx(o.SZ,{children:"Mantenha sua conta segura com uma senha forte"})]}),(0,a.jsxs)(o.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx(c._,{htmlFor:"currentPassword",children:"Senha Atual *"}),a.jsx(u.W,{id:"currentPassword",value:x,onChange:e=>h(e.target.value),placeholder:"Digite sua senha atual",disabled:E})]}),(0,a.jsxs)("div",{children:[a.jsx(c._,{htmlFor:"newPassword",children:"Nova Senha *"}),a.jsx(u.W,{id:"newPassword",value:p,onChange:e=>g(e.target.value),placeholder:"Digite sua nova senha",showStrength:p.length>0,strength:R.strength,disabled:E}),p&&!R.isValid&&(0,a.jsxs)("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx("p",{className:"text-sm font-medium text-red-800 mb-2",children:"Requisitos de senha:"}),a.jsx("ul",{className:"text-xs text-red-700 space-y-1",children:R.errors.map((e,s)=>(0,a.jsxs)("li",{className:"flex items-center",children:[a.jsx("div",{className:"w-1 h-1 bg-red-600 rounded-full mr-2"}),e]},s))})]}),p&&R.isValid&&a.jsx("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx(S.Z,{className:"h-4 w-4 text-green-600 mr-2"}),(0,a.jsxs)("p",{className:"text-sm font-medium text-green-800",children:["Senha v\xe1lida! For\xe7a: ",(0,_.xy)(R.strength)]})]})})]}),(0,a.jsxs)("div",{children:[a.jsx(c._,{htmlFor:"confirmPassword",children:"Confirmar Nova Senha *"}),a.jsx(u.W,{id:"confirmPassword",value:f,onChange:e=>A(e.target.value),placeholder:"Confirme sua nova senha",disabled:E}),f&&p!==f&&a.jsx("p",{className:"text-sm text-red-600 mt-1",children:"As senhas n\xe3o coincidem"})]}),a.jsx("div",{className:"pt-4",children:a.jsx(d.z,{onClick:V,disabled:E||!R.isValid||p!==f||!x,className:"w-full bg-[#D4AF37] hover:bg-[#B8941F] text-black",children:E?"Alterando...":"Alterar Senha"})}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Dicas de Seguran\xe7a:"}),(0,a.jsxs)("ul",{className:"text-xs text-blue-800 space-y-1",children:[a.jsx("li",{children:"• Use uma combina\xe7\xe3o de letras mai\xfasculas e min\xfasculas"}),a.jsx("li",{children:"• Inclua n\xfameros e caracteres especiais"}),a.jsx("li",{children:"• Evite informa\xe7\xf5es pessoais \xf3bvias"}),a.jsx("li",{children:"• Use pelo menos 8 caracteres (recomendado: 12+)"}),a.jsx("li",{children:"• N\xe3o reutilize senhas de outras contas"})]})]})]})]})})]})]})}):null}},31606:(e,s,r)=>{"use strict";r.d(s,{C:()=>l});var a=r(62901);r(24383);var t=r(47279),n=r(68637);let i=(0,t.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:s,...r}){return a.jsx("div",{className:(0,n.cn)(i({variant:s}),e),...r})}},250:(e,s,r)=>{"use strict";r.d(s,{I:()=>i});var a=r(62901),t=r(24383),n=r(68637);let i=t.forwardRef(({className:e,type:s,...r},t)=>a.jsx("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...r}));i.displayName="Input"},82657:(e,s,r)=>{"use strict";r.d(s,{_:()=>d});var a=r(62901),t=r(24383),n=r(8388),i=r(47279),l=r(68637);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=t.forwardRef(({className:e,...s},r)=>a.jsx(n.f,{ref:r,className:(0,l.cn)(o(),e),...s}));d.displayName=n.f.displayName},34366:(e,s,r)=>{"use strict";r.d(s,{W:()=>c});var a=r(62901),t=r(24383),n=r(34216),i=r(91334),l=r(250),o=r(27878),d=r(68637);function c({className:e,showStrength:s=!1,strength:r="weak",...c}){let[u,m]=(0,t.useState)(!1);return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"relative",children:[a.jsx(l.I,{...c,type:u?"text":"password",className:(0,d.cn)("pr-10",e)}),a.jsx(o.z,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>m(!u),children:u?a.jsx(n.Z,{className:"h-4 w-4 text-gray-400"}):a.jsx(i.Z,{className:"h-4 w-4 text-gray-400"})})]}),s&&(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("div",{className:"flex h-2 w-full overflow-hidden rounded-full bg-gray-200",children:a.jsx("div",{className:(0,d.cn)("transition-all duration-300 ease-out",(()=>{switch(r){case"weak":return"bg-red-500";case"medium":return"bg-yellow-500";case"strong":return"bg-green-500";default:return"bg-gray-300"}})(),(()=>{switch(r){case"weak":return"w-1/3";case"medium":return"w-2/3";case"strong":return"w-full";default:return"w-0"}})())})}),(0,a.jsxs)("p",{className:(0,d.cn)("text-xs font-medium","weak"===r&&"text-red-600","medium"===r&&"text-yellow-600","strong"===r&&"text-green-600"),children:["For\xe7a da senha: ","weak"===r&&"Fraca","medium"===r&&"M\xe9dia","strong"===r&&"Forte"]})]})]})}},83025:(e,s,r)=>{"use strict";function a(e){let s=[],r="weak";return e.length<8&&s.push("A senha deve ter pelo menos 8 caracteres"),/[A-Z]/.test(e)||s.push("A senha deve conter pelo menos uma letra mai\xfascula"),/\d/.test(e)||s.push("A senha deve conter pelo menos um n\xfamero"),/[a-z]/.test(e)||s.push("A senha deve conter pelo menos uma letra min\xfascula"),0===s.length&&(e.length>=12&&/[!@#$%^&*(),.?":{}|<>]/.test(e)?r="strong":e.length>=10&&(r="medium")),{isValid:0===s.length,errors:s,strength:r}}function t(e){switch(e){case"weak":return"Fraca";case"medium":return"M\xe9dia";case"strong":return"Forte";default:return"Indefinida"}}r.d(s,{uo:()=>a,xy:()=>t}),r(21475)},76021:(e,s,r)=>{"use strict";r.d(s,{Z:()=>a});let a=(0,r(71945).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},19918:(e,s,r)=>{"use strict";r.d(s,{Z:()=>a});let a=(0,r(71945).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},28376:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>a});let a=(0,r(88895).createProxy)(String.raw`/home/ubuntu/crm-security-updated/app/app/perfil/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),a=s.X(0,[372,446,362,226,376,36],()=>r(2063));module.exports=a})();